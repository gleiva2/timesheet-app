{"ast":null,"code":"import _objectSpread from \"/home/gerson/Documents/node-tutorials/timesheet-app/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"/home/gerson/Documents/node-tutorials/timesheet-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectWithoutProperties from \"/home/gerson/Documents/node-tutorials/timesheet-app/client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nvar _excluded = [\"onRedirectCallback\", \"redirectUri\"];\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.search.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport Vue from 'vue';\nimport createAuth0Client from '@auth0/auth0-spa-js';\n/** Define a default action to perform after authentication */\n\nvar DEFAULT_REDIRECT_CALLBACK = function DEFAULT_REDIRECT_CALLBACK() {\n  return window.history.replaceState({}, document.title, window.location.pathname);\n};\n\nvar instance;\n/** Returns the current instance of the SDK */\n\nexport var getInstance = function getInstance() {\n  return instance;\n};\n/** Creates an instance of the Auth0 SDK. If one has already been created, it returns that instance */\n\nexport var useAuth0 = function useAuth0(_ref) {\n  var _ref$onRedirectCallba = _ref.onRedirectCallback,\n      onRedirectCallback = _ref$onRedirectCallba === void 0 ? DEFAULT_REDIRECT_CALLBACK : _ref$onRedirectCallba,\n      _ref$redirectUri = _ref.redirectUri,\n      redirectUri = _ref$redirectUri === void 0 ? \"\".concat(window.location.origin, \"/timesheet-app\") : _ref$redirectUri,\n      options = _objectWithoutProperties(_ref, _excluded);\n\n  if (instance) return instance; // The 'instance' is simply a Vue object\n\n  instance = new Vue({\n    data: function data() {\n      return {\n        loading: true,\n        isAuthenticated: false,\n        user: {},\n        auth0Client: null,\n        popupOpen: false,\n        error: null\n      };\n    },\n    methods: {\n      /** Authenticates the user using a popup window */\n      loginWithPopup: function loginWithPopup(options, config) {\n        var _this = this;\n\n        return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n          return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _this.popupOpen = true;\n                  _context.prev = 1;\n                  _context.next = 4;\n                  return _this.auth0Client.loginWithPopup(options, config);\n\n                case 4:\n                  _context.next = 6;\n                  return _this.auth0Client.getUser();\n\n                case 6:\n                  _this.user = _context.sent;\n                  _context.next = 9;\n                  return _this.auth0Client.isAuthenticated();\n\n                case 9:\n                  _this.isAuthenticated = _context.sent;\n                  _this.error = null;\n                  _context.next = 17;\n                  break;\n\n                case 13:\n                  _context.prev = 13;\n                  _context.t0 = _context[\"catch\"](1);\n                  _this.error = _context.t0; // eslint-disable-next-line\n\n                  console.error(_context.t0);\n\n                case 17:\n                  _context.prev = 17;\n                  _this.popupOpen = false;\n                  return _context.finish(17);\n\n                case 20:\n                  _context.next = 22;\n                  return _this.auth0Client.getUser();\n\n                case 22:\n                  _this.user = _context.sent;\n                  _this.isAuthenticated = true;\n\n                case 24:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, null, [[1, 13, 17, 20]]);\n        }))();\n      },\n\n      /** Handles the callback when logging in using a redirect */\n      handleRedirectCallback: function handleRedirectCallback() {\n        var _this2 = this;\n\n        return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n          return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _this2.loading = true;\n                  _context2.prev = 1;\n                  _context2.next = 4;\n                  return _this2.auth0Client.handleRedirectCallback();\n\n                case 4:\n                  _context2.next = 6;\n                  return _this2.auth0Client.getUser();\n\n                case 6:\n                  _this2.user = _context2.sent;\n                  _this2.isAuthenticated = true;\n                  _this2.error = null;\n                  _context2.next = 14;\n                  break;\n\n                case 11:\n                  _context2.prev = 11;\n                  _context2.t0 = _context2[\"catch\"](1);\n                  _this2.error = _context2.t0;\n\n                case 14:\n                  _context2.prev = 14;\n                  _this2.loading = false;\n                  return _context2.finish(14);\n\n                case 17:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, null, [[1, 11, 14, 17]]);\n        }))();\n      },\n\n      /** Authenticates the user using the redirect method */\n      loginWithRedirect: function loginWithRedirect(o) {\n        return this.auth0Client.loginWithRedirect(o);\n      },\n\n      /** Returns all the claims present in the ID token */\n      getIdTokenClaims: function getIdTokenClaims(o) {\n        return this.auth0Client.getIdTokenClaims(o);\n      },\n\n      /** Returns the access token. If the token is invalid or missing, a new one is retrieved */\n      getTokenSilently: function getTokenSilently(o) {\n        return this.auth0Client.getTokenSilently(o);\n      },\n\n      /** Gets the access token using a popup window */\n      getTokenWithPopup: function getTokenWithPopup(o) {\n        return this.auth0Client.getTokenWithPopup(o);\n      },\n\n      /** Logs the user out and removes their session on the authorization server */\n      logout: function logout(o) {\n        return this.auth0Client.logout(o);\n      }\n    },\n\n    /** Use this lifecycle method to instantiate the SDK client */\n    created: function created() {\n      var _this3 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var _yield$_this3$auth0Cl, appState;\n\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return createAuth0Client(_objectSpread(_objectSpread({}, options), {}, {\n                  client_id: options.clientId,\n                  redirect_uri: redirectUri\n                }));\n\n              case 2:\n                _this3.auth0Client = _context3.sent;\n                _context3.prev = 3;\n\n                if (!(window.location.search.includes('code=') && window.location.search.includes('state='))) {\n                  _context3.next = 11;\n                  break;\n                }\n\n                _context3.next = 7;\n                return _this3.auth0Client.handleRedirectCallback();\n\n              case 7:\n                _yield$_this3$auth0Cl = _context3.sent;\n                appState = _yield$_this3$auth0Cl.appState;\n                _this3.error = null; // Notify subscribers that the redirect callback has happened, passing the appState\n                // (useful for retrieving any pre-authentication state)\n\n                onRedirectCallback(appState);\n\n              case 11:\n                _context3.next = 16;\n                break;\n\n              case 13:\n                _context3.prev = 13;\n                _context3.t0 = _context3[\"catch\"](3);\n                _this3.error = _context3.t0;\n\n              case 16:\n                _context3.prev = 16;\n                _context3.next = 19;\n                return _this3.auth0Client.isAuthenticated();\n\n              case 19:\n                _this3.isAuthenticated = _context3.sent;\n                _context3.next = 22;\n                return _this3.auth0Client.getUser();\n\n              case 22:\n                _this3.user = _context3.sent;\n                _this3.loading = false;\n                return _context3.finish(16);\n\n              case 25:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[3, 13, 16, 25]]);\n      }))();\n    }\n  });\n  return instance;\n}; // Create a simple Vue plugin to expose the wrapper object throughout the application\n\nexport var Auth0Plugin = {\n  install: function install(Vue, options) {\n    Vue.prototype.$auth = useAuth0(options);\n  }\n};","map":{"version":3,"sources":["/home/gerson/Documents/node-tutorials/timesheet-app/client/src/auth/index.js"],"names":["Vue","createAuth0Client","DEFAULT_REDIRECT_CALLBACK","window","history","replaceState","document","title","location","pathname","instance","getInstance","useAuth0","onRedirectCallback","redirectUri","origin","options","data","loading","isAuthenticated","user","auth0Client","popupOpen","error","methods","loginWithPopup","config","getUser","console","handleRedirectCallback","loginWithRedirect","o","getIdTokenClaims","getTokenSilently","getTokenWithPopup","logout","created","client_id","clientId","redirect_uri","search","includes","appState","Auth0Plugin","install","prototype","$auth"],"mappings":"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","sourcesContent":["import Vue from 'vue';\nimport createAuth0Client from '@auth0/auth0-spa-js';\n\n/** Define a default action to perform after authentication */\nconst DEFAULT_REDIRECT_CALLBACK = () =>\n  window.history.replaceState({}, document.title, window.location.pathname);\n\nlet instance;\n\n/** Returns the current instance of the SDK */\nexport const getInstance = () => instance;\n\n/** Creates an instance of the Auth0 SDK. If one has already been created, it returns that instance */\nexport const useAuth0 = ({\n  onRedirectCallback = DEFAULT_REDIRECT_CALLBACK,\n  redirectUri = `${window.location.origin}/timesheet-app`,\n  ...options\n}) => {\n  if (instance) return instance;\n\n  // The 'instance' is simply a Vue object\n  instance = new Vue({\n    data() {\n      return {\n        loading: true,\n        isAuthenticated: false,\n        user: {},\n        auth0Client: null,\n        popupOpen: false,\n        error: null\n      };\n    },\n    methods: {\n      /** Authenticates the user using a popup window */\n      async loginWithPopup(options, config) {\n        this.popupOpen = true;\n\n        try {\n          await this.auth0Client.loginWithPopup(options, config);\n          this.user = await this.auth0Client.getUser();\n          this.isAuthenticated = await this.auth0Client.isAuthenticated();\n          this.error = null;\n        } catch (e) {\n          this.error = e;\n          // eslint-disable-next-line\n          console.error(e);\n        } finally {\n          this.popupOpen = false;\n        }\n\n        this.user = await this.auth0Client.getUser();\n        this.isAuthenticated = true;\n      },\n      /** Handles the callback when logging in using a redirect */\n      async handleRedirectCallback() {\n        this.loading = true;\n        try {\n          await this.auth0Client.handleRedirectCallback();\n          this.user = await this.auth0Client.getUser();\n          this.isAuthenticated = true;\n          this.error = null;\n        } catch (e) {\n          this.error = e;\n        } finally {\n          this.loading = false;\n        }\n      },\n      /** Authenticates the user using the redirect method */\n      loginWithRedirect(o) {\n        return this.auth0Client.loginWithRedirect(o);\n      },\n      /** Returns all the claims present in the ID token */\n      getIdTokenClaims(o) {\n        return this.auth0Client.getIdTokenClaims(o);\n      },\n      /** Returns the access token. If the token is invalid or missing, a new one is retrieved */\n      getTokenSilently(o) {\n        return this.auth0Client.getTokenSilently(o);\n      },\n      /** Gets the access token using a popup window */\n\n      getTokenWithPopup(o) {\n        return this.auth0Client.getTokenWithPopup(o);\n      },\n      /** Logs the user out and removes their session on the authorization server */\n      logout(o) {\n        return this.auth0Client.logout(o);\n      }\n    },\n    /** Use this lifecycle method to instantiate the SDK client */\n    async created() {\n      // Create a new instance of the SDK client using members of the given options object\n      this.auth0Client = await createAuth0Client({\n        ...options,\n        client_id: options.clientId,\n        redirect_uri: redirectUri\n      });\n\n      try {\n        // If the user is returning to the app after authentication..\n        if (\n          window.location.search.includes('code=') &&\n          window.location.search.includes('state=')\n        ) {\n          // handle the redirect and retrieve tokens\n          const { appState } = await this.auth0Client.handleRedirectCallback();\n\n          this.error = null;\n\n          // Notify subscribers that the redirect callback has happened, passing the appState\n          // (useful for retrieving any pre-authentication state)\n          onRedirectCallback(appState);\n        }\n      } catch (e) {\n        this.error = e;\n      } finally {\n        // Initialize our internal authentication state\n        this.isAuthenticated = await this.auth0Client.isAuthenticated();\n        this.user = await this.auth0Client.getUser();\n        this.loading = false;\n      }\n    }\n  });\n\n  return instance;\n};\n\n// Create a simple Vue plugin to expose the wrapper object throughout the application\nexport const Auth0Plugin = {\n  install(Vue, options) {\n    Vue.prototype.$auth = useAuth0(options);\n  }\n};"]},"metadata":{},"sourceType":"module"}